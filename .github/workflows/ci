  - name: Use Node.js ${{ matrix.node-version }}
    uses: actions/setup-node@v4
    with:
      node-version: ${{ matrix.node-version }}
      cache: 'npm'

  - name: Cache npm
    uses: actions/cache@v4
    with:
      path: ~/.npm
      key: ${{ runner.os }}-node-${{ matrix.node-version }}-${{ hashFiles('**/package-lock.json') }}
      restore-keys: |
        ${{ runner.os }}-node-${{ matrix.node-version }}-

  - name: Install dependencies
    run: npm ci

  - name: Run ESLint
    run: npm run lint --if-present

  - name: Run TypeScript type check
    run: npx tsc --noEmit

  - name: Optional - Build (verifies production build)
    if: success()
    run: npm run build --if-present
